#id: "org.mal-lang.attack-scenario"
#version: "1.0.0"

//

category System {
  asset Network {
    | access
      -> hosts.connect
    & connect
  }

/// here, hosts allows to connect and communicate 


  asset Host {
    | connect
      -> network.access
    | access
      -> authenticate
    | authenticate
      -> accessBankingSoftware, accessOfficeSuite, accessProjectManagementSoftware, accessNetwork
    | accessBankingSoftware
      -> bankingSoftware.manipulateTransactions
    | accessOfficeSuite
      -> officeSuite.communicate
    | accessProjectManagementSoftware
      -> projectManagementSoftware.projectInfo
    | accessNetwork
      -> deployRansomware
    | deployRansomware
      -> ransomwareDeployed
    | ransomwareDeployed [Exponential(0.5)]
      -> systemEncryption
    | guessPassword
      -> guessedPassword
    | guessedPassword [Exponential(0.02)]
      -> authenticate
    & access
  }

  asset User {
    | attemptPhishing
      -> phishingSuccess
    | phishingSuccess [Exponential(0.1)]
      -> passwords.obtain
    | access
      -> host.access
  }

  asset Password {       // host can be authenticated and accessed once the password has been obtained
    | obtain
      -> host.authenticate
  }

  asset BankingSoftware {
    | manipulateTransactions
      -> financialDamage
  }

  asset OfficeSuite {        //host can use the office suite for communication
    | communicate
      -> phishingEmail
    | phishingEmail
      -> user.attemptPhishing
  }

  asset ProjectManagementSoftware {    // to obtain project related information host access the project management software
    | projectInfo
      -> gainInsiderKnowledge
    | gainInsiderKnowledge
      -> exploitInsiderKnowledge
  }

  asset NetworkAccess {      //ransomware can be deployed if ransomware is accessed
    | deployRansomware
      -> systemEncryption
    | systemEncryption
      -> impactCriticalInfrastructure
  }
}

category Attacker {                            //this is the place where attackers are trying  the phishing  email
  asset MaliciousActor {
    | attemptPhishing
      -> phishingEmailSent
    | phishingEmailSent [Exponential(0.1)]
      -> user.attemptPhishing
    | attemptDDoS
      -> ddosAttack
    | ddosAttack [Exponential(0.25)]
      -> serviceDisruption
    | attemptRansomware
      -> deployRansomware
    | deployRansomware [Exponential(0.4)]
      -> host.deployRansomware
  }
}

associations {
  Network [network] 1 <-- NetworkAccess --> * [hosts] Host    // associations represents that network can connect to multiple hosts
  Host [host] 1 <-- Credentials --> * [passwords] Password
  User [user] 1 <-- Credentials --> * [passwords] Password
  Host [host] 1 <-- Access --> * [network] Network
  Host [bankingSystem] 1 <-- Uses --> 1 [bankingSoftware] BankingSoftware
  Host [officeSystem] 1 <-- Uses --> 1 [officeSuite] OfficeSuite
  Host [projectSystem] 1 <-- Uses --> 1 [projectSoftware] ProjectManagementSoftware
}
